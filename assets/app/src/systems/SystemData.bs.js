// Generated by BUCKLESCRIPT VERSION 3.0.0, PLEASE EDIT WITH CARE
'use strict';

var $$Map = require("bs-platform/lib/js/map.js");
var List = require("bs-platform/lib/js/list.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Fetch = require("bs-fetch/src/Fetch.js");
var Int32 = require("bs-platform/lib/js/int32.js");
var Json_decode = require("@glennsl/bs-json/src/Json_decode.bs.js");

var SystemMap = $$Map.Make([Int32.compare]);

function getSystemMap(systems) {
  return List.fold_left((function (map, system) {
                return Curry._3(SystemMap[/* add */3], system[/* id */0], system, map);
              }), SystemMap[/* empty */0], systems);
}

function getSystemFromMap(id, systemMap) {
  return Curry._2(SystemMap[/* find */21], id, systemMap);
}

function decodeSystem(json) {
  return /* record */[
          /* id */Json_decode.field("id", Json_decode.$$int, json),
          /* name */Json_decode.field("name", Json_decode.string, json),
          /* description */Json_decode.field("description", Json_decode.string, json)
        ];
}

function decodeSystems(json) {
  return Json_decode.list(decodeSystem, json);
}

function getSystems() {
  return fetch("/api/systems").then((function (prim) {
                  return prim.json();
                })).then((function (json) {
                return Promise.resolve(Json_decode.field("data", decodeSystems, json));
              }));
}

function createSystem(draftSystem) {
  var systemDict = { };
  systemDict["name"] = draftSystem[/* name */0];
  systemDict["description"] = draftSystem[/* description */1];
  var payload = { };
  payload["system"] = systemDict;
  return fetch("/api/systems", Fetch.RequestInit[/* make */0](/* Some */[/* Post */2], /* Some */[{
                          "Content-Type": "application/json"
                        }], /* Some */[JSON.stringify(payload)], /* None */0, /* None */0, /* None */0, /* None */0, /* None */0, /* None */0, /* None */0, /* None */0)(/* () */0)).then((function (prim) {
                  return prim.json();
                })).then((function (json) {
                return Promise.resolve(Json_decode.field("data", decodeSystem, json));
              }));
}

exports.SystemMap = SystemMap;
exports.getSystemMap = getSystemMap;
exports.getSystemFromMap = getSystemFromMap;
exports.decodeSystem = decodeSystem;
exports.decodeSystems = decodeSystems;
exports.getSystems = getSystems;
exports.createSystem = createSystem;
/* SystemMap Not a pure module */
